@model IEnumerable<eManager.Web.Models.Event>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Title)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.StartDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.EndDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Description)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.IsActive)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Title)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.StartDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.EndDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Description)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.IsActive)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.EventID }) |
            @Html.ActionLink("Details", "Details", new { id=item.EventID }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.EventID })
        </td>
    </tr>
}

</table>

<div id="calendar"></div>

@section styles {
    <link href="~/Scripts/fullcalendar/fullcalendar.css" rel="stylesheet" />
}

@section scripts {
    <script type="text/javascript" src="~/Scripts/fullcalendar/fullcalendar.js"></script>
    <script type="text/javascript">
        $('#calendar').fullCalendar({
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay',
                height: 550,
            },
            events: function (start, end, callback) {
                $.getJSON("@Url.Action("GetEvents")", function (locationsArray) {
                    var result = $(locationsArray).map(function () {
                        return {
                            title: this.Title,
                            start: this.StartDate,
                            end: this.EndDate,
                            allDay: this.IsEditable,
                            url: "Details/" + this.EventID
                        };
                    }).toArray();
                    callback(result);
                });
            },

            allDaySlot: false,
            timeFormat: 'h:mm tt{ - h:mm} tt',
            dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
            dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
            editable: false,
            defaultView: 'month',
            droppable: false,
        });
    </script>
}